{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 57,
  "summary": "Build “VR Homes Infra CRM” with distinct Admin and Agent dashboards, role-based access, agent self-registration (phone/email/face) requiring admin approval, and modules for customers, leads, follow-ups (including overdue automation), attendance (live location + face), WhatsApp actions, settings (theme + Hindi/English), and full admin visibility into agent/customer activities.",
  "architectural_notes": [
    "Plan for role-based access control with separate Admin/Agent dashboards and a shared login entry point that routes by role/approval status.",
    "Agent onboarding requires face recognition capture and admin approval; store face image for display in admin panel.",
    "Attendance requires live location/address capture and face authentication at check-in.",
    "Integrations needed for WhatsApp messaging and phone call initiation from within the app.",
    "App must support theming and i18n (Hindi/English).",
    "Seed/initialize default Admin profile details: name 'Vipin Maurya' and mobile number '7217637770' (used for initial admin account/contact info).",
    "Enforce unique constraint on user mobile numbers (especially Agent accounts) to prevent duplicate registrations; if a mobile number already exists, block registration and direct the user to login (or recovery flow if needed).",
    "Seed/initialize default Admin profile email id as 'infravrhomes@gmail.com' (in addition to name 'Vipin Maurya' and mobile '7217637770').",
    "Frontend uses Internet Identity integration hooks (useInternetIdentity/useActor) as part of the authentication flow; ensure II provider requirements remain enforced via lint/build rules.",
    "Repository now includes a build-template workspace for ICP deployment (canister.yaml configs, deploy.sh, Dockerfile) and scripts for image handling (resize/prune) to standardize builds/releases."
  ],
  "known_issues": [
    "Production deployment is failing (\"Production deployment failed: Deployment failed\"), preventing the app from going live.",
    "App is taking too long on the loading page / slow load time reported by user (\"Taking to time on loading page\", \"Not going Live, taking too many time\").",
    "Agent approval is not showing after agent registration (pending/approval status not visible/updating in Admin Agents approval flow)."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "IF-1",
      "title": "Backend role-based access control and authorization layer",
      "synonyms": [
        "RBAC",
        "authorization"
      ],
      "description": "Introduced backend authorization/access-control modules to support role-based routing and permissions for Admin vs Agent experiences.",
      "reqIds": [
        "REQ-2",
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "Shared Auth page with Admin login and Agent registration/login flows",
      "synonyms": [
        "unified auth",
        "shared login"
      ],
      "description": "Frontend AuthPage with LoginForm and RegisterForm, using a single entry point for both roles.",
      "reqIds": [
        "REQ-3",
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Agent face-image capture component for onboarding/profile setup",
      "synonyms": [
        "face capture",
        "camera capture"
      ],
      "description": "Camera capture/upload flow implemented via CameraCapture/useCamera and profile setup modal to collect face image during onboarding.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Agent approval workflow UI (pending/approved agent lists)",
      "synonyms": [
        "admin approval",
        "user approval"
      ],
      "description": "Implemented agent approval workflow scaffolding including PendingAgentsList and ApprovedAgentsList, backed by user-approval backend module changes.",
      "reqIds": [
        "REQ-19",
        "REQ-5",
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "Admin and Agent dashboard pages with role-specific panel components",
      "synonyms": [
        "dashboards",
        "role-based navigation"
      ],
      "description": "Created AdminDashboard and AgentDashboard pages and role-specific module components (customers, leads, follow-ups, WhatsApp).",
      "reqIds": [
        "REQ-1",
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Customers module UI for Admin and Agent",
      "synonyms": [
        "customer management"
      ],
      "description": "Implemented customer list/views and add customer dialog for Admin and Agent (AdminCustomersList, AgentCustomersList, AdminAddCustomerDialog).",
      "reqIds": [
        "REQ-6",
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Leads module UI (Admin/Agent lists and add lead dialog)",
      "synonyms": [
        "lead management"
      ],
      "description": "Implemented leads list panels (AdminLeadsList, AgentLeadsList) and AdminAddLeadDialog UI scaffolding.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Follow-ups module UI for Admin and Agent",
      "synonyms": [
        "follow ups"
      ],
      "description": "Implemented follow-up list panels for Admin and Agent (AdminFollowUpsList, AgentFollowUpsList).",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "WhatsApp and calling actions UI panels",
      "synonyms": [
        "wa.me",
        "tel links"
      ],
      "description": "Implemented AdminWhatsAppPanel and AgentWhatsAppPanel to support WhatsApp/call actions from within the app UI.",
      "reqIds": [
        "REQ-10",
        "REQ-27",
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "Admin Overview panel with module summary cards and quick navigation",
      "synonyms": [
        "admin overview",
        "overview dashboard cards"
      ],
      "description": "Implemented an AdminOverviewPanel that summarizes key module counts/sections and provides quick navigation by clicking summary cards to open related Admin modules.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "IF-11",
      "title": "Project build template + shared UI component library scaffolding (shadcn-ui)",
      "synonyms": [
        "build-template",
        "shadcn-ui components",
        "deployment scaffold"
      ],
      "description": "Added/updated the repository build-template infrastructure (Dockerfile, deploy scripts, ICP canister configs, workspace/package setup) and introduced/expanded a shared shadcn-ui component set and related frontend build/lint configuration to standardize UI and packaging.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-12",
      "title": "Admin Invoice panel UI scaffolding",
      "synonyms": [
        "invoices",
        "billing panel"
      ],
      "description": "Introduced an AdminInvoicePanel component as part of the Admin UI module set (UI scaffolding only, based on component presence).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-13",
      "title": "Startup gating + performance instrumentation for initial load",
      "synonyms": [
        "StartupGate",
        "startup guards",
        "startup performance"
      ],
      "description": "Added a StartupGate/startup-guards flow and startup performance utilities to better control app initialization and diagnose/mitigate slow loading behavior during startup.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-14",
      "title": "Production stabilization/deployment hardening documentation and config updates",
      "synonyms": [
        "production stabilization",
        "deployment hardening"
      ],
      "description": "Introduced production stabilization guidance and updated build/deploy template/configuration files to improve reliability of production builds and deployments.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-admin-agent-approval-views-to-clearly-surface-backend-fetch-errors-e-g-authorization-or-failed-query-instead-of-silently-showing-an-empty-pending-list-so-admins-can-distinguish-no-pending-agents-from-cannot-load-pending-agents",
      "title": "Update the frontend Admin agent approval views to clearly surface backend fetch errors (e.g., authorization or failed query) instead of silently showing an empty pending list, so admins can distinguish \"no pending agents\" from \"cannot load pending agents\".",
      "reqIds": [
        "REQ-36"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-4",
      "summary": "Admin dashboard modules: Overview, Agents (name/contact/email/live status/pending approval), Customers, Follow-ups, Attendance (all agents history), WhatsApp, Settings",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Agent dashboard modules: Overview, Customers, Follow-ups, Attendance (self + history), WhatsApp, Leads (self-assigned only, mandatory remarks within 8 hours), Settings",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Follow-up automation: after overdue follow-up, automatically message customer and enable direct phone calling from the app",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Attendance feature: capture agent attendance with live location address and face authentication; provide admin view of all agents and agent self-history",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Settings: chat theme customization and language switch (Hindi/English); admin can change details of all panels except Attendance settings",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Implement Admin 'Agents' panel showing: agent name, contact number, email, live/online status, and pending approval status; include face image preview; enable Admin approve/reject with optional rejection reason.",
      "reqIds": [
        "REQ-5"
      ],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Implement Follow-up module for both roles: create follow-ups linked to a customer with due date/time and notes; show overdue follow-ups; provide actions to generate an automatic message and to initiate a phone call via device dialer link.",
      "reqIds": [
        "REQ-7"
      ],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Implement Attendance module: agents can submit attendance with a face image capture/upload and a manually entered 'current address' string; store attendance history; Admin can view attendance history for all agents; Agent can view self history.",
      "reqIds": [
        "REQ-8"
      ],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Implement Leads module for Agent: agent can add leads manually; a lead is always assigned to the creating agent only; enforce that a remark must be provided within 8 hours of lead creation and clearly surface overdue remark status.",
      "reqIds": [
        "REQ-9"
      ],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Add Settings for both roles: chat theme selection (multiple presets) and language selection (English/Hindi). Admin settings can also edit configurable aspects of other panels except Attendance settings; Agent settings apply to the agent user only.",
      "reqIds": [
        "REQ-11"
      ],
      "status": "pending"
    },
    {
      "id": "AR-22",
      "summary": "Add activity tracking visible to Admin: record key agent/customer actions (registration submitted, approval changes, customer created/edited, follow-up created/completed, lead created/remark added, attendance submitted) and show them in Admin views (Overview and/or a dedicated activity list).",
      "reqIds": [
        "REQ-12"
      ],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Apply a coherent, non-blue/non-purple visual theme across the entire app (layout, typography, spacing, components) suitable for a real-estate CRM; keep Admin and Agent dashboards visually consistent but clearly labeled.",
      "reqIds": [
        "REQ-13"
      ],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "Add generated static image assets (logo + app icon) and render them in the UI (auth page header, app sidebar/topbar). Store generated images under frontend/public/assets/generated and reference them directly from the frontend.",
      "reqIds": [
        "REQ-14"
      ],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Extend Follow-up module so Agents can create follow-ups for both Customers and Leads (not only Customers)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Seed/initialize the primary Admin profile with Admin name “Vipin Maurya” and mobile number “7217637770”, and allow Admin login using the seeded credentials.",
      "reqIds": [
        "REQ-17"
      ],
      "status": "pending"
    },
    {
      "id": "AR-31",
      "summary": "Implement Admin dashboard modules and navigation: Overview, Agents, Customers, Follow-ups, Attendance, WhatsApp, Settings. Overview must show summary cards for each module and allow clicking a card to open the module.",
      "reqIds": [
        "REQ-20"
      ],
      "status": "pending"
    },
    {
      "id": "AR-32",
      "summary": "Implement Agent dashboard modules and navigation: Overview, Customers, Follow-ups, Attendance, WhatsApp, Leads, Settings. Agent can add follow-ups for both customers and leads.",
      "reqIds": [
        "REQ-21"
      ],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "Implement Leads module for Agent: agent can add leads manually; lead is always assigned only to the creating agent; enforce that a remark is mandatory within 8 hours of lead creation and clearly display overdue remark status.",
      "reqIds": [
        "REQ-23"
      ],
      "status": "pending"
    },
    {
      "id": "AR-35",
      "summary": "Implement Follow-ups module for both roles: create follow-ups with due date/time and remarks; show overdue follow-ups; allow linking follow-ups to a Customer or a Lead; Admin can see all follow-ups; Agent can see only own follow-ups.",
      "reqIds": [
        "REQ-24"
      ],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "Implement Attendance module using practical web inputs: agent submits attendance with a face image (capture/upload) and a manually entered current address string; store attendance history; Admin can view all agents’ attendance history; Agent can view own history.",
      "reqIds": [
        "REQ-26"
      ],
      "status": "pending"
    },
    {
      "id": "AR-39",
      "summary": "Implement Admin visibility into all agent and customer activities by recording key actions (agent registration submitted, approval changes, customer created, lead created/remark added, follow-up created, attendance submitted) and displaying them in Admin (Overview and/or a dedicated activity list).",
      "reqIds": [
        "REQ-28"
      ],
      "status": "pending"
    },
    {
      "id": "AR-40",
      "summary": "Implement Admin Agents panel fields: agent name, contact number, email id, live/online status, and pending approval status; include face image preview; allow approve/reject actions.",
      "reqIds": [
        "REQ-29"
      ],
      "status": "pending"
    },
    {
      "id": "AR-41",
      "summary": "Implement Settings for both roles: chat theme selection (include presets: warm white, dark, light red, light blue, light green, ocean) and language selection (English and Hindi). Admin Settings additionally provides configuration editing for other panels except Attendance.",
      "reqIds": [
        "REQ-30"
      ],
      "status": "pending"
    },
    {
      "id": "AR-42",
      "summary": "Apply one coherent, real-estate CRM visual theme across the app (do not use blue/purple as primary colors), keeping Admin and Agent dashboards consistent but clearly labeled by role.",
      "reqIds": [
        "REQ-31"
      ],
      "status": "pending"
    },
    {
      "id": "AR-43",
      "summary": "Generate and add static brand assets (logo and app icon) and render them in the UI (e.g., auth header and dashboard sidebar/topbar). Store generated images under frontend/public/assets/generated and reference them from the frontend.",
      "reqIds": [
        "REQ-32"
      ],
      "status": "pending"
    },
    {
      "id": "AR-44",
      "summary": "Enforce unique mobile-number registration: a mobile number can be registered only once; after first registration, the user must log in (no duplicate registrations)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-45",
      "summary": "Ensure that when an Agent registers, the registration is persisted in the backend in a way that makes the Agent immediately appear in the Admin pending-approval workflow.",
      "reqIds": [
        "REQ-33"
      ],
      "status": "pending"
    },
    {
      "id": "AR-46",
      "summary": "Make `getAllAgentProfiles()` return an approval `status` that is consistent with the approval system (UserApproval state), so Admin UI filtering (pending/approved/rejected) works reliably for every agent profile.",
      "reqIds": [
        "REQ-34"
      ],
      "status": "pending"
    },
    {
      "id": "AR-47",
      "summary": "Ensure Admin approval actions update the same underlying agent approval state that is displayed in Admin lists, so approving/rejecting a pending agent immediately moves the agent between Pending and Approved views.",
      "reqIds": [
        "REQ-35"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "VR Homes Infra CRM",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}