{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Admin Pending Agents: surface backend fetch errors with retry",
  "requirements": [
    {
      "id": "REQ-36",
      "summary": "Show clear, retryable error states in Admin agent approval views when loading agent profiles fails (vs silently showing empty lists).",
      "acceptanceCriteria": [
        "If `useGetAllAgentProfiles()` fails, the Admin pending agents panel shows an error state with a readable English message and a retry action (or guidance to re-login).",
        "If `useGetAllAgentProfiles()` succeeds and there are truly no pending agents, the UI continues to show: \"No pending agent registrations at this time.\""
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/PendingAgentsList.tsx",
          "operation": "modify",
          "description": "Add explicit fetch error handling for `useGetAllAgentProfiles()` (use query `error`/`isError`) and render a distinct error panel with a readable English message and a Retry action (calling `refetch`). If the error indicates authorization (e.g., includes \"Unauthorized\"), include guidance to re-login. Ensure the existing successful-empty state message remains unchanged. This aligns with the authorization component’s guidance to handle authorization failures gracefully; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Adjust `useGetAllAgentProfiles()` React Query options to support reliable error surfacing in the UI (e.g., disable auto-retry if it obscures persistent authorization failures, and ensure the query exposes `error`/`isError`/`refetch` to consumers). This complements the authorization component’s requirement to present authorization failures clearly; verify the component's usage instructions before implementing."
        }
      ]
    }
  ]
}